<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Korea Visual Diary â€“ ë‚˜ì˜ í•œêµ­ ì¶”ì–µ ì§€ë„</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Nanum+Myeongjo:wght@400;700;800&display=swap" rel="stylesheet">

  <!-- Leaflet -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <style>
    :root {
      --bg1: #504E76;
      --bg2: #C4C3E3;
      --sand: #FDF8E2;
      --leaf: #A3B565;
      --sun: #FCDD9D;
      --accent: #F1642E;
      --card: #ffffff;
      --ink: #252336;
      --muted: #6b6985;
      --glass: rgba(255,255,255,0.12);
      --glass-border: rgba(255,255,255,0.35);
      --shadow-soft: 0 18px 40px rgba(0,0,0,.28);
      --radius-xl: 26px;
      --radius-lg: 18px;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      height: 100%;
      font-family: "Gowun Dodum", "Noto Sans KR", system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      color: var(--sand);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      background: radial-gradient(circle at 20% 0%, var(--sun) 0, transparent 50%),
                  radial-gradient(circle at 80% 0%, #E4E3FF 0, transparent 50%),
                  linear-gradient(180deg, var(--bg1), var(--bg2));
      display: flex;
      align-items: stretch;
      justify-content: center;
      padding: 20px;
      min-height: 100vh;
    }

    .app {
      width: 100%;
      max-width: 1280px;
      background: linear-gradient(135deg, rgba(255,255,255,0.12), rgba(255,255,255,0.04));
      border-radius: var(--radius-xl);
      border: 1px solid rgba(255,255,255,.25);
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(22px) saturate(150%);
      display: flex;
      flex-direction: column;
      padding: 18px 22px;
    }

    /* HEADER */
    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    .title-block h1 {
      margin: 0;
      font-size: 22px;
      letter-spacing: .05em;
      text-transform: uppercase;
      color: #fff;
      font-family: "Nanum Myeongjo", "Gowun Dodum", "Noto Sans KR", serif;
      font-weight: 700;
    }

    .title-block p {
      margin: 2px 0 0;
      font-size: 13px;
      color: var(--sun);
    }

    .year-filters {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .year-chip {
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.35);
      background: rgba(0,0,0,.12);
      color: #fdfdfd;
      font-size: 13px;
      padding: 7px 13px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      backdrop-filter: blur(16px);
      transition: background .2s ease, transform .15s ease, box-shadow .2s ease, border-color .2s ease;
      font-family: "Gowun Dodum", sans-serif;
    }

    .year-chip:hover:not(.disabled):not(.active) {
      transform: translateY(-1px);
      background: rgba(0,0,0,.2);
    }

    .year-chip span.count {
      font-size: 11px;
      opacity: .9;
    }

    .year-chip.active {
      background: var(--accent);
      border-color: rgba(255,255,255,.75);
      box-shadow: 0 0 16px rgba(241,100,46,.45);
      transform: translateY(-1px);
    }

    .year-chip.disabled {
      opacity: .45;
      cursor: default;
    }

    /* LAYOUT */
    .content {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 2.1fr);
      gap: 16px;
      margin-top: 6px;
      min-height: 520px;
    }

    @media (max-width: 960px) {
      .content {
        grid-template-columns: 1fr;
      }
    }

    /* LEFT: MAP + LIST */
    .left-panel {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .map-shell {
      position: relative;
      border-radius: var(--radius-lg);
      padding: 12px;
      background: linear-gradient(145deg, rgba(0,0,0,0.35), rgba(0,0,0,0.75));
      overflow: hidden;
      min-height: 260px;
    }

    /* Circular globe map */
    .map-globe {
      position: relative;
      width: 100%;
      aspect-ratio: 1/1;
      border-radius: 999px;
      overflow: hidden;
      box-shadow: 0 20px 50px rgba(0,0,0,.7);
      border: 2px solid rgba(255,255,255,.15);
    }

    .map-globe .leaflet-container {
      width: 100%;
      height: 100%;
      background: #1a1a2e;
    }

    .map-globe .leaflet-tile-pane {
      filter: brightness(0.85) contrast(1.1) saturate(0.9);
    }

    .map-caption {
      position: absolute;
      left: 14px;
      bottom: 12px;
      font-size: 11px;
      color: rgba(253,248,226,.9);
      background: rgba(0,0,0,.35);
      padding: 4px 8px;
      border-radius: 999px;
      backdrop-filter: blur(10px);
      z-index: 1000;
      pointer-events: none;
    }

    .map-category-badge {
      position: absolute;
      right: 14px;
      top: 12px;
      font-size: 11px;
      color: #201b2a;
      background: rgba(253,248,226,.95);
      padding: 5px 10px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      gap: 4px;
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
      z-index: 1000;
      pointer-events: none;
      font-family: "Gowun Dodum", sans-serif;
    }

    /* CATEGORY FILTERS */
    .filters-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 4px;
    }

    .tag {
      font-size: 11px;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.27);
      color: #fdfdfd;
      background: rgba(0,0,0,.18);
      cursor: pointer;
      backdrop-filter: blur(14px);
      display: flex;
      align-items: center;
      gap: 4px;
      transition: background .2s, transform .15s, box-shadow .2s, border-color .2s;
      font-family: "Gowun Dodum", sans-serif;
    }

    .tag:hover:not(.disabled):not(.active) {
      transform: translateY(-1px);
      background: rgba(0,0,0,.25);
    }

    .tag span.icon {
      font-size: 12px;
    }

    .tag.active {
      background: var(--leaf);
      border-color: rgba(255,255,255,.75);
      box-shadow: 0 0 14px rgba(163,181,101,.55);
      transform: translateY(-1px);
    }

    .tag.disabled {
      opacity: .4;
      cursor: default;
    }

    /* PLACE LIST */
    .place-list {
      margin-top: 8px;
      flex: 1;
      min-height: 180px;
      max-height: 280px;
      overflow-y: auto;
      overflow-x: hidden;
      padding-right: 6px;
    }

    .place-list::-webkit-scrollbar {
      width: 6px;
    }

    .place-list::-webkit-scrollbar-track {
      background: rgba(0,0,0,.2);
      border-radius: 3px;
    }

    .place-list::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,.3);
      border-radius: 3px;
    }

    .place-card {
      background: rgba(15,12,40,.75);
      border-radius: 14px;
      padding: 8px 10px;
      margin-bottom: 6px;
      border: 1px solid rgba(255,255,255,.08);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 2px;
      transition: background .18s ease, transform .12s ease, box-shadow .18s ease, border-color .18s ease;
    }

    .place-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 26px rgba(0,0,0,.55);
      border-color: rgba(252,221,157,.55);
    }

    .place-card.active {
      background: linear-gradient(135deg, rgba(252,221,157,.55), rgba(241,100,46,.75));
      border-color: rgba(255,255,255,.85);
      box-shadow: 0 12px 30px rgba(241,100,46,.7);
      color: #201b2a;
    }

    .place-main {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    .place-name {
      font-size: 13px;
      font-weight: 600;
      font-family: "Nanum Myeongjo", "Gowun Dodum", "Noto Sans KR", serif;
    }

    .place-type {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: .11em;
      opacity: .85;
    }

    .place-meta {
      font-size: 11px;
      opacity: .85;
    }

    /* RIGHT: MEMORY CARD */
    .right-panel {
      border-radius: var(--radius-lg);
      border: 1px solid var(--glass-border);
      background: radial-gradient(circle at 0 0, rgba(252,221,157,.18), transparent 60%),
                  radial-gradient(circle at 100% 100%, rgba(163,181,101,.15), transparent 60%),
                  rgba(7,5,25,.78);
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(28px) saturate(160%);
      padding: 18px 18px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .memory-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
    }

    .memory-title {
      font-size: 18px;
      font-weight: 700;
      color: #fff;
      margin: 0;
      font-family: "Nanum Myeongjo", "Gowun Dodum", "Noto Sans KR", serif;
    }

    .memory-type-pill {
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.25);
      text-transform: uppercase;
      letter-spacing: .12em;
      display: flex;
      align-items: center;
      gap: 4px;
      font-family: "Gowun Dodum", sans-serif;
    }

    .memory-sub {
      font-size: 13px;
      color: var(--sun);
      margin: 2px 0 0;
    }

    .meta-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 6px 10px;
      margin-top: 6px;
      font-size: 11.5px;
      color: rgba(253,248,226,.9);
    }

    .meta-label {
      opacity: .7;
    }

    .glass-grid {
      margin-top: 10px;
      display: grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 8px;
    }

    .glass-cell {
      border-radius: 12px;
      padding: 10px;
      border: 1px solid rgba(255,255,255,.28);
      background: linear-gradient(135deg, rgba(255,255,255,.18), rgba(255,255,255,.06));
      color: #201c2a;
      font-size: 11.5px;
      box-shadow: 0 8px 22px rgba(0,0,0,.35);
      min-height: 56px;
    }

    .glass-cell h4 {
      margin: 0 0 4px;
      font-size: 11px;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: #504E76;
      font-family: "Nanum Myeongjo", "Gowun Dodum", "Noto Sans KR", serif;
    }

    .glass-cell p {
      margin: 0;
      color: #2f293d;
      font-family: "Gowun Dodum", sans-serif;
    }

    .memory-foot {
      margin-top: auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: rgba(253,248,226,.75);
      flex-wrap: wrap;
      gap: 8px;
    }

    .pill-small {
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.22);
      padding: 3px 8px;
      background: rgba(0,0,0,.28);
    }

    /* Memory card fade animation */
    .memory-content {
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Custom marker styles */
    .custom-marker {
      background: transparent;
      border: none;
    }

    /* Leaflet popup styling */
    .leaflet-popup-content-wrapper {
      background: rgba(7,5,25,.95);
      color: var(--sand);
      border-radius: 12px;
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,.2);
    }

    .leaflet-popup-content {
      margin: 12px 14px;
      font-family: "Gowun Dodum", sans-serif;
      font-size: 12px;
    }

    .leaflet-popup-content b {
      font-family: "Nanum Myeongjo", serif;
      font-weight: 700;
      color: #fff;
    }

    .leaflet-popup-tip {
      background: rgba(7,5,25,.95);
      border: 1px solid rgba(255,255,255,.2);
    }

    /* Mobile responsive */
    @media (max-width: 640px) {
      body {
        padding: 10px;
      }

      .app {
        padding: 14px 16px;
      }

      .title-block h1 {
        font-size: 18px;
      }

      .content {
        min-height: auto;
      }

      .map-shell {
        min-height: 220px;
      }

      .place-list {
        max-height: 200px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="title-block">
        <h1>Korea Visual Diary â€“ ë‚˜ì˜ í•œêµ­ ì¶”ì–µ ì§€ë„</h1>
        <p>Places Â· Years Â· Feelings â€” personal map-based memory project</p>
      </div>
      <div class="year-filters" id="yearFilters">
        <!-- Generated by JS -->
      </div>
    </header>

    <main class="content">
      <!-- LEFT COLUMN -->
      <section class="left-panel">
        <!-- Circular globe map -->
        <div class="map-shell">
          <div class="map-globe" id="map"></div>
          <div class="map-category-badge" id="mapCategoryBadge">
            <span class="icon">âœ¨</span><span class="label">ì „ì²´ ë³´ê¸°</span>
          </div>
          <div class="map-caption">
            ëŒ€í•œë¯¼êµ­ ì¤‘ì‹¬ìœ¼ë¡œ ë³´ëŠ” ì§€ë„ì…ë‹ˆë‹¤. ë§ˆì»¤ë¥¼ í´ë¦­í•˜ë©´ ì˜¤ë¥¸ìª½ ê¸°ì–µ ì¹´ë“œê°€ ì—´ë¦½ë‹ˆë‹¤.
          </div>
        </div>

        <!-- Category filters -->
        <div class="filters-row" id="typeFilters"></div>

        <!-- Place list -->
        <div class="place-list" id="placeList"></div>
      </section>

      <!-- RIGHT COLUMN: MEMORY CARD -->
      <section class="right-panel" id="memoryPanel">
        <div class="memory-header">
          <div>
            <h2 class="memory-title" id="memTitle">ì¥ì†Œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”</h2>
            <p class="memory-sub" id="memSub">ì™¼ìª½ ì§€ë„ë‚˜ ë¦¬ìŠ¤íŠ¸ì—ì„œ í•˜ë‚˜ì˜ í•€ì„ í´ë¦­í•˜ë©´, ì—¬ê¸°ì— ê¸°ì–µ ì¹´ë“œê°€ ì—´ë¦½ë‹ˆë‹¤.</p>
          </div>
          <div class="memory-type-pill" id="memType">
            <span class="icon">âœ¨</span><span>TYPE</span>
          </div>
        </div>

        <div class="meta-grid memory-content">
          <div>
            <div class="meta-label">ë„ì‹œ / City</div>
            <div id="memCity">â€“</div>
          </div>
          <div>
            <div class="meta-label">ì—°ë„ / Year</div>
            <div id="memYear">â€“</div>
          </div>
          <div style="grid-column:1 / -1;">
            <div class="meta-label">ì£¼ì†Œ / Address</div>
            <div id="memAddress">â€“</div>
          </div>
        </div>

        <div class="glass-grid memory-content">
          <div class="glass-cell">
            <h4>MEMO</h4>
            <p id="memNote">ë‚˜ì¤‘ì— ê° ì¥ì†Œì— ëŒ€í•œ ë‚˜ì˜ ì¸ì‚¬ì´íŠ¸ / ì¶”ì–µ í•œ ì¤„ì„ ì—¬ê¸°ì— ì ì„ ì˜ˆì •ì…ë‹ˆë‹¤.</p>
          </div>
          <div class="glass-cell">
            <h4>FOOD / TIP</h4>
            <p id="memTip">ìŒì‹ ì¶”ì²œ, ê°€ëŠ” ì‹œê°„ëŒ€, í•¨ê»˜ ê°€ê³  ì‹¶ì€ ì‚¬ëŒ ë“±ì„ ì ì„ ìˆ˜ ìˆëŠ” ê³µê°„ì…ë‹ˆë‹¤.</p>
          </div>
        </div>

        <div class="memory-foot">
          <span>â† ì™¼ìª½ì—ì„œ ë‹¤ë¥¸ í•€ì„ í´ë¦­í•˜ë©´ ë‚´ìš©ì´ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.</span>
          <span class="pill-small" id="memBadge">0 / 0 places</span>
        </div>
      </section>
    </main>
  </div>

  <script>
    /* ---------------------------
       CATEGORY CONFIG (KOREAN)
       --------------------------- */
    const CATEGORY_CONFIG = {
      all:     { key: 'all',     label: 'ì „ì²´',      icon: 'âœ¨' },
      cafe:    { key: 'cafe',    label: 'ì¹´í˜',      icon: 'â˜•' },
      food:    { key: 'food',    label: 'ìŒì‹',      icon: 'ğŸœ' },
      nature:  { key: 'nature',  label: 'ìì—°',      icon: 'ğŸŒ¿' },
      exp:     { key: 'exp',     label: 'ì²´í—˜',      icon: 'ğŸ¢' },
      culture: { key: 'culture', label: 'ì „ì‹œ/ë¬¸í™”', icon: 'ğŸ–¼ï¸' },
      study:   { key: 'study',   label: 'ê³µë¶€',      icon: 'ğŸ“š' },
      daily:   { key: 'daily',   label: 'ë„ì‹œ/ì¼ìƒ', icon: 'ğŸ™ï¸' },
      market:  { key: 'market',  label: 'ë§ˆíŠ¸/ì‹œì¥', icon: 'ğŸ›’' },
      etc:     { key: 'etc',     label: 'ê¸°íƒ€',      icon: 'â­' }
    };

    /* ---------------------------
       PLACES DATA
       --------------------------- */
    const places = [
      {id:1,  name:"Never Ending Pottery Studio", type:"art cafe",  city:"ì„œìš¸", address:"ì„œìš¸ ì–‘ì²œêµ¬ ê°€ë¡œê³µì›ë¡œ 136", year:2025},
      {id:2,  name:"ì„¸ë¸ìŠ¤í”Œë¡œì–´ 2í˜¸ì ",          type:"food",      city:"ì¸ì²œ", address:"ì¸ì²œ ë¶€í‰êµ¬ ë¶€í‰ëŒ€ë¡œ 15 ë¶€í‰ì„œíŒŒë¹Œë”© 7ì¸µ", year:2025},
      {id:3,  name:"íŒŒë¥´íˆ¬ë‚´ (Uzbek & Russian market)", type:"grocery store", city:"ì„œìš¸", address:"ì„œìš¸ ì¤‘êµ¬ ë§ˆë¥¸ë‚´ë¡œ 154 1-2ì¸µ", year:2025},
      {id:4,  name:"ë¯¸ì˜ë™ (Japanese food)",     type:"food",      city:"ì„œìš¸", address:"ì„œìš¸ ë§ˆí¬êµ¬ ë™êµë¡œ38ê¸¸ 33-21 2ì¸µ", year:2025},
      {id:5,  name:"ì´ë“œ (Eid)",                 type:"food",      city:"ì„œìš¸", address:"ì„œìš¸ ìš©ì‚°êµ¬ ìš°ì‚¬ë‹¨ë¡œ10ê¸¸ 15 1ì¸µ", year:2025},
      {id:6,  name:"íˆ¬ì¸í”Œë ˆì´ìŠ¤ ì„œìš¸ìˆ²ì—­ì ",     type:"cafe",      city:"ì„œìš¸", address:"ì„œìš¸ ì„±ë™êµ¬ ì™•ì‹­ë¦¬ë¡œ 58 í¬íœ´ 1-2ì¸µ 101,201í˜¸", year:2025},
      {id:7,  name:"ë„ë´‰ì‚°",                     type:"nature",    city:"ì„œìš¸", address:"ì„œìš¸ ë„ë´‰êµ¬ ë„ë´‰ë™ ì‚° 31", year:2025},
      {id:8,  name:"ë™ë¦¼ìº í”„",                   type:"adventure", city:"ê²½ê¸° ê°€í‰", address:"ê²½ê¸° ê°€í‰êµ° ì²­í‰ë©´ ëª¨ê¼¬ì§€ë¡œ 22-9", year:2025},
      {id:9,  name:"ê°•ë‚¨ê·¸ëœë“œì•ˆê³¼ì˜ì›",         type:"hospital",  city:"ì„œìš¸", address:"ì„œìš¸ ì„œì´ˆêµ¬ ê°•ë‚¨ëŒ€ë¡œ 363 ê°•ë‚¨íƒ€ì›Œ 4-5ì¸µ", year:2025},
      {id:10, name:"ì—°ì²œì—­ (íì—­)",              type:"adventure", city:"ê²½ê¸° ì—°ì²œ", address:"ê²½ê¸° ì—°ì²œêµ° ì—°ì²œì ì—°ì²œë¡œ 275-1", year:2025},
      {id:11, name:"ê°ì²œë¬¸í™”ë§ˆì„",               type:"adventure", city:"ë¶€ì‚°", address:"ë¶€ì‚° ì‚¬í•˜êµ¬ ê°ì²œë™ 1-17", year:2025},
      {id:12, name:"ê´‘ì•ˆë¦¬í•´ìˆ˜ìš•ì¥",             type:"beach",     city:"ë¶€ì‚°", address:"ë¶€ì‚° ìˆ˜ì˜êµ¬ ê´‘ì•ˆí•´ë³€ë¡œ 219", year:2025},
      {id:13, name:"í•´ìš´ëŒ€í•´ìˆ˜ìš•ì¥",             type:"beach",     city:"ë¶€ì‚°", address:"ë¶€ì‚° í•´ìš´ëŒ€êµ¬ ìš°ë™", year:2025},
      {id:14, name:"ì²­ì‚¬í¬ì–´í•­ë™ë°©íŒŒì œë“±ëŒ€",     type:"adventure", city:"ë¶€ì‚°", address:"ë¶€ì‚° í•´ìš´ëŒ€êµ¬ ì¤‘ë™ 591-21", year:2025},
      {id:15, name:"í•´ìš´ëŒ€ë¸”ë£¨ë¼ì¸íŒŒí¬ ë¯¸í¬ì •ê±°ì¥", type:"adventure", city:"ë¶€ì‚°", address:"ë¶€ì‚° í•´ìš´ëŒ€êµ¬ ë‹¬ë§ì´ê¸¸62ë²ˆê¸¸ 13", year:2025},
      {id:16, name:"í•´ìš´ëŒ€ë¸”ë£¨ë¼ì¸íŒŒí¬ ìŠ¤ì¹´ì´ìº¡ìŠ", type:"adventure", city:"ë¶€ì‚°", address:"ë¶€ì‚° í•´ìš´ëŒ€êµ¬ ì²­ì‚¬í¬ë¡œ 116", year:2025},
      {id:17, name:"CGV ë¯¸ì•„",                   type:"cinema",    city:"ì„œìš¸", address:"ì„œìš¸ ê°•ë¶êµ¬ ë„ë´‰ë¡œ 34 íŠ¸ë ˆì§€ì˜¤ì‡¼í•‘ëª° 9ì¸µ", year:2025},
      {id:18, name:"ê³¤ì§€ì•”ë¦¬ì¡°íŠ¸ ìŠ¤í‚¤ì¥",        type:"adventure", city:"ê²½ê¸° ê´‘ì£¼", address:"ê²½ê¸° ê´‘ì£¼ì‹œ ë„ì²™ë©´ ë„ì²™ìœ—ë¡œ 278", year:2025},
      {id:19, name:"ì ì‹¤ì¢…í•©ìš´ë™ì¥ ì ì‹¤ì•¼êµ¬ì¥",   type:"adventure", city:"ì„œìš¸", address:"ì„œìš¸ ì†¡íŒŒêµ¬ ì˜¬ë¦¼í”½ë¡œ 25", year:2025},
      {id:20, name:"ë®¤ì§€ì—„ì‚°",                   type:"art",       city:"ê°•ì› ì›ì£¼", address:"ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì›ì£¼ì‹œ ì§€ì •ë©´ ì˜¤í¬ë°¸ë¦¬2ê¸¸ 260", year:2025},
      {id:21, name:"í”¼ë…¸í‚¤ì˜¤ìˆ²",                 type:"nature",    city:"ê°•ì› ì›ì£¼", address:"ê°•ì›íŠ¹ë³„ìì¹˜ë„ ì›ì£¼ì‹œ ì‹ ë¦¼ë©´ ì†Œì•¼1ê¸¸ 72 1ì¸µ", year:2025},
      {id:22, name:"ëª¨ë‚˜ìš©í‰ ìŠ¤í‚¤ì¥",            type:"adventure", city:"ê°•ì› ì›ì£¼", address:"ê°•ì›íŠ¹ë³„ìì¹˜ë„ í‰ì°½êµ° ëŒ€ê´€ë ¹ë©´ ì˜¬ë¦¼í”½ë¡œ 715", year:2025},
      {id:23, name:"ë¬´ì„¬ë§ˆì„",                   type:"nature",    city:"ê²½ë¶ ì˜ì£¼", address:"ê²½ë¶ ì˜ì£¼ì‹œ ë¬¸ìˆ˜ë©´ ë¬´ì„¬ë¡œ234ë²ˆê¸¸ 31-12", year:2025},
      {id:24, name:"ë¶€ì„ì‚¬",                     type:"nature",    city:"ê²½ë¶ ì˜ì£¼", address:"ê²½ë¶ ì˜ì£¼ì‹œ ë¶€ì„ë©´ ë¶€ì„ì‚¬ë¡œ 345", year:2025},
      {id:25, name:"ìš©ì„¤2í˜¸ì§€",                  type:"adventure", city:"ê²½ê¸° ì•ˆì„±", address:"ê²½ê¸° ì•ˆì„±ì‹œ ì£½ì‚°ë©´ ìš©ì„¤í˜¸ìˆ˜ê¸¸ 187", year:2025},
      {id:26, name:"ì•ˆì„±ë§ì¶¤ëœë“œ",               type:"adventure", city:"ê²½ê¸° ì•ˆì„±", address:"ê²½ê¸° ì•ˆì„±ì‹œ ë³´ê°œë©´ ë‚¨ì‚¬ë‹¹ë¡œ 198", year:2025},
      {id:27, name:"Study Center",              type:"study",     city:"ì„œìš¸", address:"ì„œìš¸ ì„œëŒ€ë¬¸êµ¬ ì—°ì„¸ë¡œ2ë‹¤ê¸¸ 19", year:2025},
      {id:28, name:"ì‹œë¦½ë³´ë¼ë§¤ì¸í„°ë„·ì¤‘ë…ì˜ˆë°©ìƒë‹´ì„¼í„°", type:"study", city:"ì„œìš¸", address:"ì„œìš¸ ë™ì‘êµ¬ ì—¬ì˜ëŒ€ë°©ë¡œ20ê¸¸ 61 ì‹œë¦½ë³´ë¼ë§¤ì²­ì†Œë…„ì„¼í„° ìŠ¬ê¸°ë™ 2ì¸µ 201í˜¸", year:2025},
      {id:29, name:"ì˜ë¦¼ì§€",                     type:"nature",    city:"ì¶©ë¶ ì œì²œ", address:"ì¶©ë¶ ì œì²œì‹œ ëª¨ì‚°ë™ 241", year:2025},
      {id:30, name:"ì˜¤ì´ë„í•´ë³€",                 type:"nature",    city:"ê²½ê¸° ì‹œí¥", address:"ê²½ê¸° ì‹œí¥ì‹œ ì •ì™•ë™ 2202-4", year:2025},
      {id:31, name:"ë§›ìë‘",                     type:"food",      city:"ê²½ê¸° ì‹œí¥", address:"ê²½ê¸° ì‹œí¥ì‹œ ì˜¤ì´ë„ë¡œ 253 1ì¸µ", year:2025},
      {id:32, name:"ì†”ë‹¤ë°•ì²´í—˜íœ´ì–‘ë§ˆì„",         type:"adventure", city:"ì „ë¶ ë¬´ì£¼", address:"ì „ë¶íŠ¹ë³„ìì¹˜ë„ ë¬´ì£¼êµ° ì•ˆì„±ë©´ ì¥ë¬´ë¡œ 1637 1ì¸µ", year:2025},
      {id:33, name:"ë¨¸ë£¨ì™€ì¸ë™êµ´",               type:"adventure", city:"ì „ë¶ ë¬´ì£¼", address:"ì „ë¶íŠ¹ë³„ìì¹˜ë„ ë¬´ì£¼êµ° ì ìƒë©´ ì‚°ì„±ë¡œ 359", year:2025},
      {id:34, name:"ì‚¼ë…„ì‚°ì„± ë¶ë¬¸",              type:"nature",    city:"ì¶©ë¶ ë³´ì€", address:"ì¶©ë¶ ë³´ì€êµ° ë³´ì€ì ì–´ì•”ë¦¬ ì‚° 1-1", year:2025},
      {id:35, name:"ë³´ì€ì‚¬",                     type:"nature",    city:"ì¶©ë¶ ë³´ì€", address:"ì¶©ë¶ ë³´ì€êµ° ë³´ì€ì ì„±ì£¼1ê¸¸ 104", year:2025},
      {id:36, name:"ì†ë¦¬ì‚° ììƒì‹ë¬¼ì›",          type:"nature",    city:"ì¶©ë¶ ë³´ì€", address:"ì¶©ë¶ ë³´ì€êµ° ì†ë¦¬ì‚°ë©´ ì†ë¦¬ì‚°ë¡œ 611", year:2025},
      {id:37, name:"ë‹¬ì´ë¨¸ë¬´ëŠ”ì§‘",               type:"nature",    city:"ì¶©ë¶ ì˜ë™", address:"ì¶©ë¶ ì˜ë™êµ° í™©ê°„ë©´ ì›”ë¥˜ë´‰ê¸¸ 57", year:2025},
      {id:38, name:"ì›”ë¥˜ì •",                     type:"nature",    city:"ì¶©ë¶ ì˜ë™", address:"ì¶©ë¶ ì˜ë™êµ° í™©ê°„ë©´ ì›ì´Œë¦¬ ì‚° 20-1", year:2025},
      {id:39, name:"ì‹œí¥ê°¯ê³¨ìƒíƒœê³µì›",           type:"nature",    city:"ê²½ê¸° ì‹œí¥", address:"ê²½ê¸° ì‹œí¥ì‹œ ë™ì„œë¡œ 287", year:2025},
      {id:40, name:"ì•ˆë™í•˜íšŒë§ˆì„",               type:"nature",    city:"ê²½ë¶ ì•ˆë™", address:"ê²½ë¶ ì•ˆë™ì‹œ í’ì²œë©´ í•˜íšŒë¦¬ 1176-1", year:2025},
      {id:41, name:"íƒˆë†€ì´ì „ìˆ˜ê´€",               type:"nature",    city:"ê²½ë¶ ì•ˆë™", address:"ê²½ë¶ ì•ˆë™ì‹œ í’ì²œë©´ í•˜íšŒì¢…ê°€ê¸¸ 3-15", year:2025},
      {id:42, name:"í˜¸ê³„ì„œì›",                   type:"nature",    city:"ê²½ë¶ ì•ˆë™", address:"ê²½ë¶ ì•ˆë™ì‹œ ë„ì‚°ë©´ í‡´ê³„ë¡œ 2001-36", year:2025},
      {id:43, name:"ë„ì‚°ì„œì›",                   type:"nature",    city:"ê²½ë¶ ì•ˆë™", address:"ê²½ë¶ ì•ˆë™ì‹œ ë„ì‚°ë©´ ë„ì‚°ì„œì›ê¸¸ 154", year:2025},
      {id:44, name:"ì•ˆë™íšŒê´€",                   type:"food",      city:"ê²½ë¶ ì•ˆë™", address:"ê²½ë¶ ì•ˆë™ì‹œ íƒœì‚¬ê¸¸ 71", year:2025},
      {id:45, name:"ì›”ì˜ë³´íŠ¸",                   type:"nature",    city:"ê²½ë¶ ì•ˆë™", address:"ê²½ë¶ ì•ˆë™ì‹œ ìƒì•„ë™ 569", year:2025},
      {id:46, name:"ì•ˆë™êµ­ì œì»¨ë²¤ì…˜ì„¼í„° & ì„¸ê³„ìœ êµë¬¸í™”ë°•ë¬¼ê´€", type:"adventure", city:"ê²½ë¶ ì•ˆë™", address:"ê²½ë¶ ì•ˆë™ì‹œ ë„ì‚°ë©´ ì›”ì²œê¸¸ 301", year:2025},
      {id:47, name:"yaniyan art home",           type:"art",       city:"ì„œìš¸", address:"ì„œìš¸ ê°•ë‚¨êµ¬ ì••êµ¬ì •ë¡œ14ê¸¸ 39", year:2025},
      {id:48, name:"ë””ë®¤ì§€ì—„",                   type:"art",       city:"ì„œìš¸", address:"ì„œìš¸ ì„±ë™êµ¬ ì™•ì‹­ë¦¬ë¡œ 83-21 1-4ì¸µ", year:2025},
      {id:49, name:"ë‘ë¼ë–¡ë³¶ì´ ëª…ë™ì—­ì ",        type:"food",      city:"ì„œìš¸", address:"ì„œìš¸ ì¤‘êµ¬ ëª…ë™10ê¸¸ 35-3 2ì¸µ", year:2025},
      {id:50, name:"FNCì—”í„°í…Œì¸ë¨¼íŠ¸ ì²­ë‹´",        type:"adventure", city:"ì„œìš¸", address:"ì„œìš¸ ê°•ë‚¨êµ¬ ë„ì‚°ëŒ€ë¡œ85ê¸¸ 46", year:2025},
      {id:51, name:"ë§ˆì´ì•„íŠ¸ë®¤ì§€ì—„ ì›ê·¸ë¡œë¸Œì ",   type:"art",       city:"ì„œìš¸", address:"ì„œìš¸ ê°•ì„œêµ¬ ê³µí•­ëŒ€ë¡œ 165 ì›ê·¸ë¡œë¸Œ Cë™ 2ì¸µ W213í˜¸", year:2025},
      {id:52, name:"ì†”ë‚´ìŒì‚°ì´Œë§ˆì„",             type:"nature",    city:"ì „ë¶ ë¬´ì£¼", address:"ì „ë¶íŠ¹ë³„ìì¹˜ë„ ë¬´ì£¼êµ° ì•ˆì„±ë©´ ì¹ ì—°ë¡œ 504", year:2025},
      {id:53, name:"ì¹´í˜ëŒì²´",                   type:"cafe",      city:"ì„œìš¸", address:"ì„œìš¸ ì„œì´ˆêµ¬ ì˜¬ë¦¼í”½ëŒ€ë¡œ 2085-14 ê°€ë¹›ì„¬ 1ì¸µ", year:2025},
      {id:54, name:"ë‹¤ë¯¸",                       type:"food",      city:"ì„œìš¸", address:"ì„œìš¸ ì˜ë“±í¬êµ¬ êµ­ì œê¸ˆìœµë¡œ8ê¸¸ 34 ì˜¤ë¥œë¹Œë”© 1ì¸µ", year:2025},
      {id:55, name:"ë§ˆë¼ê³µë°© íšŒí˜„ì ",             type:"food",      city:"ì„œìš¸", address:"ì„œìš¸ ì¤‘êµ¬ ë‚¨ëŒ€ë¬¸ì‹œì¥ê¸¸ 73 3ì¸µ", year:2025}
    ];

    function mapTypeToCategoryKey(type) {
      const t = String(type || '').toLowerCase();
      if (t === 'cafe' || t === 'art cafe') return 'cafe';
      if (t === 'food') return 'food';
      if (t === 'nature' || t === 'beach') return 'nature';
      if (t === 'adventure' || t === 'cinema') return 'exp';
      if (t === 'art') return 'culture';
      if (t === 'study') return 'study';
      if (t === 'grocery store') return 'market';
      if (t === 'hospital') return 'daily';
      return 'etc';
    }

    places.forEach(p => {
      p.category = mapTypeToCategoryKey(p.type);
      p.coords = null;
    });

    const yearFiltersEl = document.getElementById('yearFilters');
    const typeFiltersEl = document.getElementById('typeFilters');
    const placeListEl = document.getElementById('placeList');
    const mapCategoryBadge = document.getElementById('mapCategoryBadge');

    const memTitle = document.getElementById('memTitle');
    const memSub = document.getElementById('memSub');
    const memType = document.getElementById('memType');
    const memCity = document.getElementById('memCity');
    const memYear = document.getElementById('memYear');
    const memAddress = document.getElementById('memAddress');
    const memNote = document.getElementById('memNote');
    const memTip = document.getElementById('memTip');
    const memBadge = document.getElementById('memBadge');

    let currentYear = 2025;
    let currentCategory = 'all';
    let activeId = null;

    /* ---------------------------
       GEOCODING WITH CACHE
       --------------------------- */
    const GEOCODE_CACHE_KEY = 'korea_diary_geocode_cache';
    const CACHE_EXPIRY_DAYS = 30;

    function getGeocodeCache() {
      try {
        const cached = localStorage.getItem(GEOCODE_CACHE_KEY);
        if (!cached) return {};
        const data = JSON.parse(cached);
        const now = Date.now();
        const filtered = {};
        for (const [key, value] of Object.entries(data)) {
          if (now - value.timestamp < CACHE_EXPIRY_DAYS * 24 * 60 * 60 * 1000) {
            filtered[key] = value;
          }
        }
        return filtered;
      } catch (e) {
        return {};
      }
    }

    function setGeocodeCache(address, coords) {
      try {
        const cache = getGeocodeCache();
        cache[address] = { coords, timestamp: Date.now() };
        localStorage.setItem(GEOCODE_CACHE_KEY, JSON.stringify(cache));
      } catch (e) {
        // ignore
      }
    }

    async function geocodePlace(place) {
      if (place.coords) return place.coords;

      const cache = getGeocodeCache();
      const cached = cache[place.address];
      if (cached) {
        place.coords = cached.coords;
        return place.coords;
      }

      const query = place.address || (place.city + ' ' + place.name);
      const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&countrycodes=kr&limit=1`;

      try {
        const res = await fetch(url, {
          headers: {
            "Accept": "application/json"
          }
        });
        const data = await res.json();
        if (data && data[0]) {
          const lat = parseFloat(data[0].lat);
          const lon = parseFloat(data[0].lon);
          const coords = [lat, lon];
          place.coords = coords;
          setGeocodeCache(place.address, coords);
          return coords;
        }
      } catch (e) {
        console.warn('Geocoding error for', place.name, e);
      }
      return null;
    }

    /* ---------------------------
       CUSTOM MARKER ICONS
       --------------------------- */
    function createMarkerIcon(category) {
      const config = CATEGORY_CONFIG[category] || CATEGORY_CONFIG.etc;
      const iconHtml = `
        <div style="
          width: 32px;
          height: 32px;
          background: rgba(252,221,157,0.95);
          border: 2px solid rgba(241,100,46,0.8);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        ">
          <span style="
            transform: rotate(45deg);
            font-size: 16px;
            display: block;
          ">${config.icon}</span>
        </div>
      `;

      return L.divIcon({
        html: iconHtml,
        className: 'custom-marker',
        iconSize: [32, 32],
        iconAnchor: [16, 32],
        popupAnchor: [0, -32]
      });
    }

    /* ---------------------------
       LEAFLET MAP INIT
       --------------------------- */
    let map;
    let markersLayer;

    function initMap() {
      if (map) return;

      const southWest = L.latLng(33.0, 124.0);
      const northEast = L.latLng(38.8, 132.0);
      const bounds = L.latLngBounds(southWest, northEast);

      map = L.map('map', {
        zoomControl: false,
        attributionControl: false,
        maxBounds: bounds,
        maxBoundsViscosity: 1.0,
        minZoom: 6,
        maxZoom: 15
      }).setView([36.3, 127.8], 7);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution: ''
      }).addTo(map);

      markersLayer = L.layerGroup().addTo(map);

      setTimeout(() => {
        map.invalidateSize();
      }, 200);
    }

    function highlightPlaceCard(id) {
      const cards = placeListEl.querySelectorAll('.place-card');
      cards.forEach(card => {
        if (Number(card.dataset.id) === id) {
          card.classList.add('active');
          card.scrollIntoView({ block: 'center', behavior: 'smooth' });
        } else {
          card.classList.remove('active');
        }
      });
    }

    async function updateMapMarkers(filteredPlaces) {
      if (!map) return;
      markersLayer.clearLayers();

      if (filteredPlaces.length === 0) return;

      const bounds = [];

      for (const p of filteredPlaces) {
        const coords = await geocodePlace(p);
        if (!coords) continue;

        const icon = createMarkerIcon(p.category);
        const marker = L.marker(coords, { icon }).addTo(markersLayer);

        marker.bindPopup(`
          <b>${p.name}</b><br>
          ${p.city}<br>
          ${p.address}
        `);

        marker.on('click', () => {
          activeId = p.id;
          updateMemoryCard(p, filteredPlaces.length);
          highlightPlaceCard(p.id);
          map.setView(coords, Math.max(map.getZoom(), 11), {
            animate: true,
            duration: 0.5
          });
        });

        bounds.push(coords);
      }

      if (bounds.length > 0) {
        try {
          map.fitBounds(bounds, { padding: [30, 30], maxZoom: 9 });
        } catch (e) {
          map.setView([36.3, 127.8], 7);
        }
      } else {
        map.setView([36.3, 127.8], 7);
      }
    }

    function getYearsWithCounts() {
      const counts = {};
      places.forEach(p => {
        counts[p.year] = (counts[p.year] || 0) + 1;
      });
      return counts;
    }

    function buildYearFilters() {
      const counts = getYearsWithCounts();
      const years = [2022, 2023, 2024, 2025];
      yearFiltersEl.innerHTML = '';

      years.forEach(y => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'year-chip';
        if (!counts[y]) btn.classList.add('disabled');
        if (y === currentYear) btn.classList.add('active');
        btn.dataset.year = y;
        btn.innerHTML = `${y} <span class="count">(${counts[y] || 0})</span>`;
        btn.addEventListener('click', () => {
          if (!counts[y]) return;
          currentYear = y;
          activeId = null;
          currentCategory = 'all';
          buildYearFilters();
          buildTypeFilters();
          renderPlaces();
          resetMemoryCard();
          updateMapCategoryBadge();
        });
        yearFiltersEl.appendChild(btn);
      });
    }

    function getCategoryCountsForYear(year) {
      const counts = {};
      places.forEach(p => {
        if (p.year !== year) return;
        const c = p.category || 'etc';
        counts[c] = (counts[c] || 0) + 1;
      });
      return counts;
    }

    function buildTypeFilters() {
      const counts = getCategoryCountsForYear(currentYear);
      typeFiltersEl.innerHTML = '';

      const allConfig = CATEGORY_CONFIG.all;
      const allBtn = document.createElement('button');
      allBtn.type = 'button';
      allBtn.className = 'tag' + (currentCategory === 'all' ? ' active' : '');
      allBtn.innerHTML = `<span class="icon">${allConfig.icon}</span><span>${allConfig.label}</span>`;
      allBtn.addEventListener('click', () => {
        currentCategory = 'all';
        activeId = null;
        buildTypeFilters();
        renderPlaces();
        resetMemoryCard();
        updateMapCategoryBadge();
      });
      typeFiltersEl.appendChild(allBtn);

      const keysInOrder = ['cafe', 'food', 'nature', 'exp', 'culture', 'study', 'daily', 'market', 'etc'];
      keysInOrder.forEach(key => {
        const cfg = CATEGORY_CONFIG[key];
        const count = counts[key] || 0;
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'tag';
        if (currentCategory === key) btn.classList.add('active');
        if (!count) btn.classList.add('disabled');
        btn.innerHTML = `<span class="icon">${cfg.icon}</span><span>${cfg.label}${count ? ` (${count})` : ''}</span>`;
        btn.addEventListener('click', () => {
          if (!count) return;
          currentCategory = key;
          activeId = null;
          buildTypeFilters();
          renderPlaces();
          resetMemoryCard();
          updateMapCategoryBadge();
        });
        typeFiltersEl.appendChild(btn);
      });
    }

    async function renderPlaces() {
      const filtered = places.filter(p => {
        if (p.year !== currentYear) return false;
        if (currentCategory !== 'all' && p.category !== currentCategory) return false;
        return true;
      });

      placeListEl.innerHTML = '';

      filtered.forEach(p => {
        const card = document.createElement('div');
        card.className = 'place-card' + (p.id === activeId ? ' active' : '');
        card.dataset.id = p.id;

        const catCfg = CATEGORY_CONFIG[p.category] || CATEGORY_CONFIG.etc;
        card.innerHTML = `
          <div class="place-main">
            <div class="place-name">${p.name}</div>
            <div class="place-type">${catCfg.icon} ${catCfg.label}</div>
          </div>
          <div class="place-meta">${p.city} Â· ${p.address}</div>
        `;

        card.addEventListener('click', () => {
          activeId = p.id;
          renderPlaces();
          updateMemoryCard(p, filtered.length);
          updateMapCategoryBadge(p.category);
          if (map && p.coords) {
            map.setView(p.coords, Math.max(map.getZoom(), 12), {
              animate: true,
              duration: 0.5
            });
          }
        });

        placeListEl.appendChild(card);
      });

      memBadge.textContent = `${filtered.length} / ${places.length} places`;

      await updateMapMarkers(filtered);
    }

    function resetMemoryCard() {
      memTitle.textContent = 'ì¥ì†Œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”';
      memSub.textContent = 'ì™¼ìª½ ì§€ë„ë‚˜ ë¦¬ìŠ¤íŠ¸ì—ì„œ í•˜ë‚˜ì˜ í•€ì„ í´ë¦­í•˜ë©´, ì—¬ê¸°ì— ê¸°ì–µ ì¹´ë“œê°€ ì—´ë¦½ë‹ˆë‹¤.';
      memType.innerHTML = `<span class="icon">âœ¨</span><span>TYPE</span>`;
      memCity.textContent = 'â€“';
      memYear.textContent = 'â€“';
      memAddress.textContent = 'â€“';
      memNote.textContent = 'ë‚˜ì¤‘ì— ê° ì¥ì†Œì— ëŒ€í•œ ë‚˜ì˜ ì¸ì‚¬ì´íŠ¸ / ì¶”ì–µ í•œ ì¤„ì„ ì—¬ê¸°ì— ì ì„ ì˜ˆì •ì…ë‹ˆë‹¤.';
      memTip.textContent = 'ìŒì‹ ì¶”ì²œ, ê°€ëŠ” ì‹œê°„ëŒ€, í•¨ê»˜ ê°€ê³  ì‹¶ì€ ì‚¬ëŒ ë“±ì„ ì ì„ ìˆ˜ ìˆëŠ” ê³µê°„ì…ë‹ˆë‹¤.';
    }

    function getCategoryConfig(catKey) {
      return CATEGORY_CONFIG[catKey] || CATEGORY_CONFIG.etc;
    }

    function updateMemoryCard(place, countInList) {
      const catCfg = getCategoryConfig(place.category);

      const contentElements = document.querySelectorAll('.memory-content');
      contentElements.forEach(el => {
        el.style.animation = 'none';
        setTimeout(() => {
          el.style.animation = 'fadeIn 0.3s ease-in-out';
        }, 10);
      });

      memTitle.textContent = place.name;
      memSub.textContent = `${place.city} Â· ${place.address}`;
      memType.innerHTML = `<span class="icon">${catCfg.icon}</span><span>${catCfg.label}</span>`;
      memCity.textContent = place.city;
      memYear.textContent = place.year;
      memAddress.textContent = place.address;

      if (place.note) {
        memNote.textContent = place.note;
      } else {
        memNote.textContent = 'ì—¬ê¸°ì— ì´ ì¥ì†Œì— ëŒ€í•œ ë‚˜ì˜ ê¸°ì–µ/ì¸ì‚¬ì´íŠ¸ë¥¼ ì‘ì„±í•  ì˜ˆì •ì…ë‹ˆë‹¤.';
      }

      if (place.tip) {
        memTip.textContent = place.tip;
      } else {
        if (place.category === 'food' || place.category === 'cafe') {
          memTip.textContent = 'ì´ ì¥ì†Œì—ì„œ ë¨¹ì—ˆë˜ ìŒì‹, ì¶”ì²œ ë©”ë‰´, ë‹¤ì‹œ ê°€ê³  ì‹¶ì€ ì´ìœ  ë“±ì„ ê¸°ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
        } else if (place.category === 'nature') {
          memTip.textContent = 'ë‚ ì”¨, ê³„ì ˆ, í•¨ê»˜ ê°”ë˜ ì‚¬ëŒ, í’ê²½ì˜ ëŠë‚Œ ë“±ì„ ê¸°ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
        } else if (place.category === 'culture') {
          memTip.textContent = 'ì „ì‹œ/ê³µì—°ì—ì„œ ì¸ìƒì ì´ì—ˆë˜ ì¥ë©´, ì‘í’ˆì— ëŒ€í•œ ìƒê°ì„ ì •ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
        } else if (place.category === 'exp') {
          memTip.textContent = 'ì²´í—˜ í™œë™, ìŠ¤í‚¤/ë†€ì´ê¸°êµ¬, ìŠ¤í˜ì…œí•œ ìˆœê°„ë“¤ì„ ê°„ë‹¨íˆ ì •ë¦¬í•´ ë³´ì„¸ìš”.';
        } else if (place.category === 'study') {
          memTip.textContent = 'ê³µë¶€ ë¶„ìœ„ê¸°, ë‚˜ì˜ ì»¨ë””ì…˜, ì´ ê³µê°„ì—ì„œ ëŠë‚€ ë™ê¸°ë¶€ì—¬ë¥¼ ê¸°ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
        } else if (place.category === 'market') {
          memTip.textContent = 'ë¬´ì—‡ì„ ìƒ€ëŠ”ì§€, ê°€ê²© ëŠë‚Œ, "í•œêµ­ì—ì„œ ì´ëŸ° ê²ƒë„ ì‚´ ìˆ˜ ìˆêµ¬ë‚˜" ê°™ì€ ì‘ì€ ë°œê²¬ì„ ì ì–´ë„ ì¢‹ì•„ìš”.';
        } else {
          memTip.textContent = 'ì´ ì¥ì†Œì—ì„œ ëŠë‚€ ê°ì •, ë°°ìš´ ì , ë‚˜ë§Œì˜ í•œ ì¤„ ë©”ì‹œì§€ë¥¼ ë‚¨ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
        }
      }

      memBadge.textContent = `${countInList} / ${places.length} places`;
    }

    function updateMapCategoryBadge(catKey) {
      let key = catKey || currentCategory;
      if (!key || key === 'all') key = 'all';
      const cfg = getCategoryConfig(key);
      const label = cfg.label === 'ì „ì²´' ? 'ì „ì²´ ë³´ê¸°' : cfg.label + ' ë³´ê¸°';
      mapCategoryBadge.innerHTML = `<span class="icon">${cfg.icon}</span><span class="label">${label}</span>`;
    }

    initMap();
    buildYearFilters();
    buildTypeFilters();
    renderPlaces();
    resetMemoryCard();
    updateMapCategoryBadge();
  </script>
</body>
</html>

